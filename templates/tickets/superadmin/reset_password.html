{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Parolni o'zgartirish" %}{% endblock %}

{% block page_title %}{% trans "Parolni o'zgartirish" %}{% endblock %}

{% block content %}
<div class="form-container">
    <div class="card" style="border: 2px solid var(--accent-warning);">
        <!-- User Info -->
        <div class="alert alert-info" style="margin-bottom: 20px;">
            <strong>{% trans "Foydalanuvchi:" %}</strong> {{ user_obj.get_full_name }}<br>
            <strong>{% trans "Username:" %}</strong> @{{ user_obj.username }}
        </div>

        <!-- Warning -->
        <div class="alert alert-warning" style="margin-bottom: 30px;">
            <strong>‚ö†Ô∏è {% trans "Diqqat!" %}</strong><br>
            {% trans "Yangi parol o'rnatilgandan so'ng foydalanuvchiga xabar yuboriladi." %}
        </div>

        <!-- Form -->
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="new_password" class="form-label">
                    {% trans "Yangi parol" %} <span style="color: var(--accent-danger);">*</span>
                </label>
                <input type="password" 
                       class="form-input" 
                       id="new_password" 
                       name="new_password" 
                       required 
                       minlength="6"
                       placeholder="{% trans 'Kamida 6 belgidan iborat' %}">
                <small class="form-help">
                    {% trans "Parol kamida 6 belgidan iborat bo'lishi kerak" %}
                </small>
            </div>

            <div class="form-group">
                <label for="confirm_password" class="form-label">
                    {% trans "Parolni tasdiqlash" %} <span style="color: var(--accent-danger);">*</span>
                </label>
                <input type="password" 
                       class="form-input" 
                       id="confirm_password" 
                       name="confirm_password" 
                       required 
                       minlength="6"
                       placeholder="{% trans 'Parolni qayta kiriting' %}">
            </div>

            <!-- Password Strength Tips -->
            <div class="info-box" style="margin-bottom: 30px;">
                <h4 style="margin: 0 0 10px 0;">üí° {% trans "Kuchli parol yaratish bo'yicha tavsiyalar:" %}</h4>
                <ul style="margin: 0; padding-left: 20px; font-size: 14px; line-height: 1.8;">
                    <li>{% trans "Kamida 8-10 belgidan foydalaning" %}</li>
                    <li>{% trans "Katta va kichik harflarni aralashtiring" %}</li>
                    <li>{% trans "Raqamlar qo'shing" %}</li>
                    <li>{% trans "Maxsus belgilar ishlatish yaxshi" %}</li>
                </ul>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-warning" style="width: 100%;">
                    üîë {% trans "Parolni o'zgartirish" %}
                </button>
                <a href="{% url 'tickets:superadmin_user_detail' user_obj.id %}" 
                   class="btn btn-secondary" style="width: 100%;">
                    ‚Üê {% trans "Bekor qilish" %}
                </a>
            </div>
        </form>
    </div>

    <!-- Quick Actions -->
    <div class="card" style="margin-top: 20px;">
        <h4 style="margin: 0 0 15px 0;">‚ö° {% trans "Tezkor harakatlar:" %}</h4>
        <div class="action-buttons-vertical">
            <a href="{% url 'tickets:superadmin_generate_temp_password' user_obj.id %}" 
               class="btn btn-info"
               onclick="return confirm('{% trans "Vaqtinchalik parol yaratilsinmi?" %}')">
                üé≤ {% trans "Tasodifiy parol generatsiya qilish" %}
            </a>
        </div>
        <small class="text-muted" style="display: block; margin-top: 10px;">
            ‚ÑπÔ∏è {% trans "Tasodifiy parol yaratiladi va ekranda ko'rsatiladi" %}
        </small>
    </div>
</div>

<script>
// Password matching validation
document.querySelector('form').addEventListener('submit', function(e) {
    var password = document.getElementById('new_password').value;
    var confirm = document.getElementById('confirm_password').value;
    
    if (password !== confirm) {
        e.preventDefault();
        alert('{% trans "Parollar bir xil emas!" %}');
        return false;
    }
    
    if (password.length < 6) {
        e.preventDefault();
        alert('{% trans "Parol kamida 6 belgidan iborat bo\'lishi kerak!" %}');
        return false;
    }
});
</script>
{% endblock %}

{% block extra_css %}
<style>
.form-container {
    max-width: 600px;
    margin: 0 auto;
}

.form-help {
    display: block;
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 5px;
}

.info-box {
    background: var(--bg-tertiary);
    padding: 20px;
    border-radius: var(--radius-sm);
}

.form-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
}

.action-buttons-vertical {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

@media (max-width: 768px) {
    .form-container {
        max-width: 100%;
    }
}
</style>
{% endblock %}